<html>
	<head>
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/css/bootstrap.min.css" integrity="sha384-rwoIResjU2yc3z8GV/NPeZWAv56rSmLldC3R/AZzGRnGxQQKnKkoFVhFQhNUwEyJ" crossorigin="anonymous"/>
		<script src="https://code.jquery.com/jquery-3.1.1.slim.min.js" integrity="sha384-A7FZj7v+d/sdmMqp/nOQwliLvUsJfDHW+k9Omg/a/EheAdgtzNs3hpfag6Ed950n" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.4.0/js/tether.min.js" integrity="sha384-DztdAPBWPRXSA/3eYEEUWrWCy7G5KFbe8fFjk5JAIxUYHKkDx6Qin1DkWx51bBrb" crossorigin="anonymous"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0-alpha.6/js/bootstrap.min.js" integrity="sha384-vBWWzlZJ8ea9aCX4pEW3rVHjgjt7zpkNpZk+02D9phzyeVkE+jo0ieGizqPLForn" crossorigin="anonymous"></script>
		<script src="https://code.jquery.com/jquery-3.3.1.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/js-sha1/0.6.0/sha1.min.js" crossorigin="anonymous"></script>
		<style type="text/css">
			.center {
				display: block;
				margin-left: auto;
				margin-right: auto;
				margin-bottom: auto;
				margin-top: auto;
			}
		</style>
		<meta charset="UTF-8"/>
	</head>
	<body>
		<form class="form-inline">
			<div class="form-group row center">
				<div class="form-group mx-sm-3 mb-2">
					<label for="example-number-input" class="col-xs-2 col-form-label">URL &nbsp</label>
					<input class="form-control center" type="text" id="url">
				</div>
				<button class="btn btn-primary mb-2" type="button" id="shorten" onclick="return false">Shorten</button>
			</div>
		</form>
	</body>
	<footer>
		<script>
			(() => {
				const isValidUrl = (string) => {
					var pattern = new RegExp('^(https?:\\/\\/)?'+ // protocol
					'((([a-z\\d]([a-z\\d-]*[a-z\\d])*)\\.)+[a-z]{2,}|'+ // domain name
					'((\\d{1,3}\\.){3}\\d{1,3}))'+ // OR ip (v4) address
					'(\\:\\d+)?(\\/[-a-z\\d%_.~+]*)*'+ // port and path
					'(\\?[;&a-z\\d%_.~+=-]*)?'+ // query string
					'(\\#[-a-z\\d_]*)?$','i'); // fragment locator
					return !!pattern.test(string);
				}

				$(window).ready(function() {
					$("#shorten").click(function(event) {
						let url = $("#url").val();

						if (!isValidUrl(url)) return alert("Invalid URL.");
						if (!url.includes("http")) return alert("URL is missing protocol.");
						$.post("/newurl", {url: url}, function (data) {
							if (data === "lmao") {
								window.location = "/images/nicetry.jpg";
							} else {
								navigator.clipboard.writeText(window.location.hostname + "/shorten?hash=" + data)
							}
						});
						event.preventDefault(); // Para no refrescar la p√°gina
					})
				});
			})();
		</script>
	</footer>
</html>